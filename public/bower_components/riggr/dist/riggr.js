/* Part of the Riggr SPA framework <https://github.com/Fluidbyte/Riggr> and released under the MIT license. This notice must remain intact. */
!function(a,b){"function"==typeof define&&define.amd?define(["router","observer","knockout","jquery"],b):"object"==typeof exports?module.exports=b(require("router"),require("observer"),require("knockout"),require("jquery")):a.riggr=b(a.router,a.observer,a.ko,a.$)}(this,function(a,b,c){var d=0,e=0,f=!1,g=0,h=[],i={controllers:"controllers",views:"views"},j="appContainer",k="viewContainer",l=function(a){f&&a&&(document.title=a+" | "+f),f&&!a&&(document.title=f),!f&&a&&(document.title=a)},m=function(a,d,e,f){var h=document.getElementById(k);$(h).fadeOut(g,function(){$(h).html(a),c.cleanNode(h),c.applyBindings(d,h),$(this).fadeIn(g),f&&d.load.apply(d,e),b.publish("onRoute")}),l(d.hasOwnProperty("pageTitle")?d.pageTitle:!1)},n=function(b,c){require([i.controllers+"/"+c],function(f){h.push(f);var g={};f.hasOwnProperty("before")&&(g.before=f.before.bind(f)),g.load=f.hasOwnProperty("load")?function(){var a=arguments;require(["text!"+i.views+"/"+c+".html"],function(b){m(b,f,a,!0)})}:function(){require(["text!"+i.views+"/"+c+".html"],function(a){m(a,f,[],!1)})},f.hasOwnProperty("unload")&&(g.unload=f.unload.bind(f)),a.on(b,g),e++,d===e&&o()})},o=function(){require([i.controllers+"/app","text!"+i.views+"/app.html"],function(d,e){$("#"+j).html(e),c.applyBindings(d),b.subscribe("onRoute",function(){d.onRoute.apply(d)}),d.hasOwnProperty("load")&&d.load.apply(d),a.process()})},p=function(a){Object.size=function(a){var b,c=0;for(b in a)a.hasOwnProperty(b)&&c++;return c},a.hasOwnProperty("paths")&&(i=a.paths),f=a.hasOwnProperty("title")?a.title:!1,l("Loading"),g=a.hasOwnProperty("transition")?a.transition:0,d=Object.size(a.routes);for(var b in a.routes)n(b,a.routes[b])};return p});